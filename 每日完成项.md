## WebSocket低延迟模式配置细分任务 2025-06-11号

### 1. WebSocket连接参数优化

- [x] **连接超时设置**：设置合理的连接超时时间（建议3-5秒）
  - [x] 检测WebSocket是否建立连接
  - [x] 检测是否收到媒体数据（连接成功后再等5秒）
  - [x] 使用最大重试次数的方式，使用指数退避(exponential backoff)的策略
  
- [x] **Ping间隔调整**：将默认的ping间隔从默认值减小至5秒
- [x] **压缩设置优化**：
  - [x] 禁用WebSocket压缩功能（对于实时流压缩会增加延迟）
  - [x] 为特定场景（低带宽环境）添加可选压缩开关

### 2. 自动重连机制实现

- [x] **断线检测**：实现WebSocket连接状态监听
- [x] **重连逻辑**：
  - [x] 设计指数退避重连算法（首次立即重连，之后间隔递增）
  - [x] 限制最大重试次数（3次）和总重试时间（15秒）
- [x] **重连状态管理**：添加重连状态指示和事件通知

## WebSocket流媒体低延迟优化方案（一天）
通过解码器参数调优、数据包处理流程优化和连接质量监控，实现WebSocket-FLV流媒体的低延迟播放，将延迟从1000ms+降至600-800ms。

## 一、解码器参数调优

### 客户端（mpegts.js/FlvPlayer）需要完成的任务

1. **解码器参数调优**
- [x] 低延迟配置参数组合实现
  
- [x] 动态缓冲区调整策略
  
- [x] 硬件加速检测与启用
2. **数据包处理流程优化**
   - [x] 接收缓冲区大小调整
   - [x] 智能丢帧策略实现
3. **连接质量监控（客户端部分）**
- [x] 数据包接收速率监控
  
- [x] 连接质量评估算法
  
- [x] 连接状态UI反馈

## 二、多分屏UI组件（2天）

### 1. 多分屏布局实现（1.5天）

- **基础分屏组件**
  - [x] 实现1/4/9分屏布局组件（Vue 3组件封装）
  - [x] 开发分屏间视频源切换功能
  - [x] 实现分屏自适应窗口大小调整
  - [x] 添加分屏选中与高亮功能

### 2. 核心功能实现（0.5天）

- **必要功能集**
  - [x] 实现基础本地抓拍功能（Canvas截图+下载）
  - [x] 开发简单的全屏模式（单屏/全局切换）
  - [x] 点击多分屏的某一个可以进行占据全部分屏
  - [x] 实现分屏自适应窗口大小调整
  - [x] 展示多分屏的地址，有两个模式一个是多分屏可以直接进行全部获取当前地址，一个是多分屏需要高亮之后点击地址才能进行播放和初始化等内容

## 三、多语言支持（1天）

### 1. 国际化框架搭建

- [x] 集成vue-i18n库
- [x] 设计语言资源文件结构（中/英/越三语）
- [x] 实现语言切换功能

### 2. 语言资源开发

- [x] 提取UI界面所有文本到语言资源文件
- [x] 完成中文、英文和越南语的基础翻译
- [x] 实现语言环境自动检测功能

## 四、集成与测试（1天）

### 1. 集成测试

- [x] 各模块集成测试
- [x] 端到端延迟测试
- [x] 多分屏性能测试
- [x] 多语言切换测试

### 2. 性能调优

- [ ] 根据测试结果进行参数微调
- [ ] 解决集成过程中发现的问题
- [ ] 完成基本文档
